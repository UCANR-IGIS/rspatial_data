---
title: "Base R Plotting"
output: html_notebook
---

## Introduction

Base R has a number of plotting functions for quick visualization of data. In this Notebook, we will explore 3 of them:

- `hist()`  
- `plot()`  
- `boxplot()`


## `hist()`

`hist()` is really useful for plotting histograms. You can control the number of bins using the `breaks` argument

```{r}
x <- c(rnorm(10000, mean = -2), rnorm(10000, mean = 2))
hist(x)
hist(x, breaks = 40)
```

`hist()` has several other arguments you can use to customize the appearance. See the help page for details.

## plot()

The basic `plot()` function is useful for quickly visualizing data as scatterplots and/or line plots.

```{r}
x <- rnorm(1000, mean = 50, sd = 5)
y <- rnorm(1000, mean = 50, sd = 5)
plot(x, y)
```

The following cod e chunk adds a few more arguments to our plot statement (note how its ok to break up a statement across lines after a comma). Play with the arguments to what see one does.

```{r}
plot(x, y,
     pch = 20,
     xlim = c(30,70),
     ylim = c(30,70),
     main = "Bivariate Normal Distribution",
     col = "purple", 
     cex = 0.75,
     axes = TRUE,
     asp = 1)
```

CHALLENGE: Plot the location of earthquakes in the `quakes` dataframe. 

```{r}
plot(x = quakes$long, 
     y = quakes$lat,
     pch = 20,
     main = "Earthquakes!",
     col = "dimgray", 
     cex = 0.8,
     asp = 1, 
     xlab = "",
     ylab = "")

```

There are *many* other arguments you can add to `plot()`, but for really nice looking plots you're better off using a plotting package like `ggmap2`, `tmap`, etc.

## Random Walk

Below we first create a set of points that simulate a 'drunken walk', and then plot it by adding the `type = "l"` argument to `plot()`. 

Notice how everytime you execute the code chunk the plot looks different. See if you can figure out how each line of code works. If there's a function you don't recognize look it up. 

```{r}
time_steps <- 100
step_length <- 10
theta <- runif(time_steps, min = 0, max = 2 * pi)
x_steps <- step_length * cos(theta)
y_steps <- step_length * sin(theta)
x_net_displacememt <- cumsum(x_steps)
y_net_displacememt <- cumsum(y_steps)

plot(x_net_displacememt,
     y_net_displacememt,
     type = "l",
     asp = 1)
```

# Box Plots

Box plots are another good




## Make a scatterplot
plot(iris$Sepal.Length, iris$Petal.Length)
%>% %>% %>% 

csv_fn <- "./data/stopping_dist_cars.csv"
file.exists(csv_fn)
stop_dist_df <- read.csv(csv_fn)
glimpse(stop_dist_df)
plot(x=stop_dist_df$speed, y=stop_dist_df$breaking_dist)



# Sample Data Frames

R comes with several sample data frames, for example `mtcars`.

```{r}
mtcars
```

Wondering where the `mtcars` data came from? Just like functions, sample datasets usually have their help pages. Run `?mtcars` to see where this one came from.

## Viewing the Properties of a Data Frame

You can view the number of **rows** and **columns** of a dataframe with `nrow()` and `ncol()`:

```{r}
nrow(mtcars)
ncol(mtcars)
```
You can view the **names** of the columns in a data frame with names():

```{r}
names(mtcars)
```

The tibble package has a nice function called `glimpse()` that will show you the names, column types, and first few values for each column in a concise format:

```{r}
tibble::glimpse(mtcars)
```

## Grabbing Columns

You can grab a single column using the `$` operator. 

Extract the values in the mpg column:

```{r}
mtcars$mpg
```
CHALLENGE: Compute the average mpg of vehicles in mtcars. [Answer](http://bit.ly/310o8bW)

```{r}
mean(mtcars$mpg)
```

CHALLENGE: Answer the following questions about the `quakes` data frame, which has data about some earthquakes: [Answer](http://bit.ly/3eUoyIV)

1) How many rows and columns does it contain?  
2) What is the average magnitude of the earthquakes recorded in this data frame?  
3) What is the minimum and maximum latitude and longitude of the earthquakes in this dataset? (hint: look at the `range()` function)  
4) In which year was the earliest earthquake recorded?  

```{r}
dim(quakes)
mean(quakes$mag)
range(quakes$lat)
range(quakes$long)

# View the help page for this data set with 
# ?quakes
# "The events occurred in a cube near Fiji since 1964."
```

## Filtering rows and columns

You can filter (subset) rows and columns using square bracket notation. Example:

`my_df[rows-expression, cols-expression]`

To view the first 5 rows of `quakes`, we pass a vector of the integers:

```{r}
quakes[1:5, ]
```

NOTE: You can omit the rows-expression or cols-expression, but you still need a comma instead the square brackets.

View every 5th row in quakes:

```{r}
quakes[ c(5, 10, 15, 20, 25), ]
```

To return rows that meet a certain condition, *rows* can be an expression that returns TRUE/FALSE values:

```{r}
## Quakes whose magnitude was >= 5.9
quakes[ quakes$mag >= 5.9,  ]
```

CHALLENGE: How many earthquakes were detected by 100 or more stations? [Answer])(http://bit.ly/3s51wTq)

```{r}
quakes[ quakes$stations >= 100,  ]
sum(quakes$stations >= 100)
```

CHALLENGE: What was the largest earthquake on record? [Answer](http://bit.ly/391H7Hs)

```{r}
max(quakes$mag)
```

You can also use the rows expression to sort the rows. The order() function returns the indices of elements in a vector sorted. 


```{r}
mag_order_idx <- order(quakes$mag)
mag_order_idx
quakes[mag_order_idx, ]
```


The *cols-expression* can be vector of integers (corresponding to column numbers you want returned), or a character vector containing column names. You can also use the cols-expression to reorder the columns.

Write an expression that will return the longitude and latitude columns only (in that order) for the biggest 10 earthquakes (by magnitude).

```{r}
mag_topten_idx <- order(quakes$mag, decreasing = TRUE)[1:10]
quakes[mag_topten_idx, ]
```

CHALLENGE: Using the mtcars data frame, compute the average mpg for 4, 6, and 8 cylinder vehicles.

```{r}
## 4 cylinder
mean(mtcars[ mtcars$cyl == 4, "mpg" ])

## 6 cylinder
mean(mtcars[ mtcars$cyl == 6, "mpg" ])

## 8 cylinder
mean(mtcars[ mtcars$cyl == 8, "mpg" ])

```



